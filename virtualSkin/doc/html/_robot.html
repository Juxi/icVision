<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>VirtualSkin: ) Baby Steps</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.2 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="contents">
<h2><a class="anchor" id="run">
Running the Code for the first time</a></h2>
<p>Start your YARP server and make sure your local machine (where you intend to run virtual skin) can see it by running: </p>
<div class="fragment"><pre class="fragment">yarp where </pre></div><p> If you do not see the IP address of the machine running your YARP server, try: </p>
<div class="fragment"><pre class="fragment">yarp detect --write </pre></div><p> For more help on YARP, read <a href="http://eris.liralab.it/yarpdoc/index.html">the YARP documentation</a>.</p>
<p>Start your iCub simulator using: </p>
<div class="fragment"><pre class="fragment">cd YOUR_ICUB_REPOSITORY_ROOT_DIR/main/bin </pre></div> <div class="fragment"><pre class="fragment">./iCub_SIM </pre></div><p> For more help on that, read <a href="http://eris.liralab.it/wiki/ODE">the iCub Simulator Installation guide</a> and <a href="http://eris.liralab.it/wiki/Simulator_README">the iCub Simulator README</a>.</p>
<p>Home the robot using the robotMotorGui: </p>
<div class="fragment"><pre class="fragment">\verbatim cd YOUR_ICUB_REPOSITORY_ROOT_DIR/main/bin </pre></div> <div class="fragment"><pre class="fragment">./robotMotorGui </pre></div><p> Uncheck 'leftleg' and 'rightleg', enter <code>icubSim</code> in the textbox and click the button. Now, at the top of the robotMotorGui window, click the tab labeled 'all' and ant button 'Home ALL Parts'. The robot should move to the home position.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>If you forget to do this, there will be collisions when you start the reflex demonstration. This is desirable behavior, as we have provided a very conservative robot model with very large bounding volumes around the iCub's body parts.</dd></dl>
<p>Start the Reflex demonstration: The following commands assume that you have compiled the source code in the directory <code>YOUR_LOCAL_GIT_REPOSITORY/virtualSkin/build</code>, that you have run  then <code>make</code> <code>install</code> in that directory, and that you have not modified the directory <code>YOUR_LOCAL_GIT_REPOSITORY/virtualSkin/xml</code> or its contents. </p>
<div class="fragment"><pre class="fragment">cd YOUR_LOCAL_GIT_REPOSITORY/virtualSkin/bin </pre></div> <div class="fragment"><pre class="fragment">./reflex --visualize --file ../xml/iCubSim.xml </pre></div><p> Now you should see a window pop up with a model of the iCub upper-body in it. Read the output in the console. You have just created a number of YARP ports called <code>/icubSimF/head/*</code>, <code>/icubSimF/torso/*</code>, ect. These are filtered ports (designated by the "F" at the end of the robot name), which forward information back and forth between their counterparts (the ports with no "F" that are associated with the hardware or simulator) and some control program. Their utility is that they only forward control commands when the robot model is in a safe configuration. As soon as the robot model is in a colliding configuration (either with itself or with an object in the environment), the filtered ports no longer forward incoming control commands (state information continues to be forwarded out to the client program), and a reflexive behavior is initiated to return the robot to a previous safe configuration. Only when the robot has reached this safe pose do the filtered ports begin to forward the client's control commands again. Try it out using the iCubBabbler!</p>
<p>Start the iCubBabbler: </p>
<div class="fragment"><pre class="fragment">cd YOUR_LOCAL_GIT_REPOSITORY/virtualSkin/bin </pre></div> <div class="fragment"><pre class="fragment">./iCubBabble --robot icubSimF [--type position | velocity] [--period (float seconds)] [--speed (int 0-100)] [--hands] </pre></div><p> Watch the simulated iCub move around randomly and bump into himself. When collision events occur, the involved geometries turn red in the robot model visualization, the filtered ports stop forwarding control commands and the reflex behavior is executed. The iCubBabbler does not know anything about the state of the robot. It simply sees that its control commands fail during certain time intervals.</p>
<p>A few words on the command line options:</p>
<ul>
<li><b>--robot</b> is followed by the name of the robot (ports) you want to connect to. This will be <code>icubF</code>, <code>icubSimF</code> or <code>icubSim</code>. If you connect the babbler to <code>icub</code>, you WILL crash the robot.</li>
<li><b>--type</b> is followed by <code>position</code> or <code>velocity</code> only, and it specifies whether the babbler should send random position or velocity control commands. If omitted, velocity commands will be sent by default.</li>
<li><b>--period</b> is followed by a floating point number of seconds, the time babbler waits between random commands.</li>
<li><b>--speed</b> controls the maximum speed of the random motions. The babbler does not check for limits as they are not available through YARP's iVelocityControl interface.</li>
<li><b>--hands</b> controls whether the thumb and fingers are also moved during babbling.</li>
</ul>
<dl class="note"><dt><b>Note:</b></dt><dd>The files <code>YOUR_LOCAL_GIT_REPOSITORY/virtualSkin/xml/iCub.xml</code> and <code>YOUR_LOCAL_GIT_REPOSITORY/virtualSkin/xml/iCubSim.xml</code> are exactly the same except for the robot name, and the kinematics and geometry therein reflect the real iCub hardware. The simulator is quite a bit different from the real iCub, so when you run the above demonstration, it will not effectively prevent the simulated iCub from colliding with itself.</dd></dl>
<p>Next Steps:</p>
<ul>
<li>skin port and filter status port</li>
<li>rpc world interface</li>
<li>xml spec and collision pair filtering</li>
</ul>
<p>2011-01-01, Kail Frank - <a href="mailto:kail@idsia.ch">kail@idsia.ch</a> </p>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.2 </small></address>
</body>
</html>
